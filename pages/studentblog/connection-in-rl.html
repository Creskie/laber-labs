<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Laber Labs</title>

    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
	<link rel="manifest" href="/site.webmanifest">

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="../../css/main.css"/>
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">

    <link href="https://fonts.googleapis.com/css?family=Josefin+Sans:300,300i,400,400i,600,600i,700,700i" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Overpass+Mono:400,700" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Mada&display=swap" rel="stylesheet">

    <!-- Hamburger to X animation -->
    <link href="../../css/hamburgers.css" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
</head>

<body>
	<nav class="navbar navbar-expand-lg fixed-top" role="navigation">
        <a class="navbar-brand" href="../../index.html"><img src="../../images/logotype.png" /></a>
            <button class="navbar-toggler hamburger hamburger--squeeze" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" type="button" aria-expanded="false">
                <span class="hamburger-box">
                    <span class="hamburger-inner"></span>
                </span>
            </button>

	    <!-- Hamburger to X animation -->
	    <script>
	      var $hamburger = $(".hamburger");
	      $hamburger.on("click", function(e) {
	        $hamburger.toggleClass("is-active");
	        // Do something else, like open/close menu
	      });
	    </script>

	    <div class="collapse navbar-collapse" id="navbarSupportedContent">
	      	<ul class="navbar-nav ml-auto tabs">
	      		<li class="nav-item"><a class="nav-link" href="../../images/ericlaber_cv.pdf">CV</a></li>
		        <li class="nav-item"><a class="nav-link" href="../team.html">Team</a></li>
		        <li class="nav-item"><a class="nav-link" href="../publications.html">Publications</a></li>
		        <li class="nav-item"><a class="nav-link" href="../projects.html">Projects</a></li>
		        <li class="nav-item dropdown">
		          	<a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Subsets
		          		<i class="fas fa-angle-down"></i>
		          	</a>
		          	<div class="dropdown-menu" role="menu">
			            <a class="dropdown-item" href="../doranslab.html">Doran's Lab</a>
			            <a class="dropdown-item" href="../donkeydarlings.html">Donkey Darlings</a>
			            <a class="dropdown-item" href="../ataristicians.html">Ataristicians</a>
		          	</div>
		        </li>
		        <li class="nav-item dropdown">
		          	<a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Games
		          		<i class="fas fa-angle-down"></i>
		          	</a>
		          	<div class="dropdown-menu" role="menu">
			            <a class="dropdown-item" href="../laserfoxes.html">Laser Foxes</a>
			            <a class="dropdown-item" href="../spacemice.html">Space Mice</a>
			            <a class="dropdown-item" href="../flyingsquirrel.html">Flying Squirrel</a>
			            <a class="dropdown-item" href="../snackattack.html">Snack Attack</a>
			            <a class="dropdown-item" href="../zombiesontreadmills.html">Zombies on Treadmills</a>
			            <a class="dropdown-item" href="../mountboredoom.html">Mount Boredoom</a>
			            <a class="dropdown-item" href="../pac-boy.html">Pac-Boy</a>
		          	</div>
		        </li>
		        <li class="nav-item dropdown">
		          	<a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Videos
		          		<i class="fas fa-angle-down"></i>
		          	</a>
		          	<div class="dropdown-menu" role="menu">
			            <a class="dropdown-item" href="../animations.html">Animations</a>
			            <a class="dropdown-item" href="../workshops.html">Workshops</a>
		          	</div>
		        </li>
		        <li class="nav-item"><a class="nav-link" href="../studentblog.html">Student Blog</a></li>
		        <li class="nav-item"><a class="nav-link" href="../contact.html">Contact</a></li>
	       	</ul>
	    </div>
	</nav>

	<header class="header-white header-blogpost header-half break-out">
		<div class="header-content header-content-blog">
			<div class="col-8 offset-2 header-content-inner">
				<h3 class="subheader-1">Connection Between Causal Inference and Off-Policy in Reinforcement Learning</h3>
				<p class="blog-info">November 25, 2018</p>
				<div class="center">
					<img class="fade-img team-photo" src="../../images/lili-wu.jpg" />
				</div>
				<p class="blog-info2"><span class="blog-highlight">Lili Wu, PhD Candidate</span></p>
			</div>
		</div>
	</header>

	<section class="additional-section blog-section">
		<div class="container-fluid col-lg-8 offset-lg-2 col-md-10 offset-md-1 col-sm-12">
			<div class="row">
				<div class="col-12">
					<p class="blog-text">Recently I am kind of excited because I suddenly realize that there are some amazing <span class="italic">similarities between causal inference and off-policy</span> in reinforcement learning. Who “stole” the other?</p>

					<p class="blog-text">Through some of the previous blogs, you may already more or less know about <span class="italic">reinforcement learning</span> (such as <a class="link" href="rl-in-education.html">Lin’s blog about reinforcement learning in education</a>), which is now very popular in Artificial Intelligence. Reinforcement learning is trying to find a sequential decision strategy to <span class="italic">maximize the long-term cumulative rewards</span>. Okay, now I am going to directly jump to introducing what off-policy is!</p>

					<p class="blog-text">To understand “off-policy” it is probably easiest to start with “on-policy.” First, a policy is a <span class="italic">“mapping” from a state to an action</span>. For example, clinicians use patient’s health information (the “state”) to recommend treatment (the “action”). Clearly, in this example, we care about how good a policy is at determining the best action. But how do we evaluate that? One way is to follow the policy, record the outcomes, and then use some measure to evaluate how good the policy is. Such a procedure is called “on-policy”–the policy is always followed. However, it may not be possible to always follow a policy. For instance, clinicians cannot give some treatments to patients because the treatment may be dangerous; some clinicians may only follow a conservative policy; or we may only have access to observational data that did not follow a specific policy. Then “off-policy” plays a role! It deals with the situation where we want to learn a policy (we call it “target policy”) while following some other different policy (“behavior policy”). Most off-policy methods use a general technique known as <span class="italic">“importance sampling”</span> to estimate the expected value. The importance sampling ratio is the relative probability of the trajectory under the target and behavior policy, so we can use it to reweight the outcomes under the behavior policy to estimate what it will be if we follow the target policy, and thus measure the “goodness” of the policy.</p>

					<p class="blog-text">Okay, if you know about <span class="italic">causal inference</span>, you may already have to be familiar with the our patient example. You only have observational data, but you want to use that data to learn the effect of some idealized treatment. In the language of our AI method—we can regard the idealized treatment as the target policy and the treatment actually assigned in the observational data as the behavior policy. Now–can we reweight the outcomes?? Yes! There was this method—<span class="italic">“inverse probability weighting”</span> proposed by Horvitz and Thompson in 1952, which is used to do the same thing as important sampling methods—reweight the outcomes! See, this is the connection between the two!</p>

					<p class="blog-text">Nowadays, there are more and more connection between causal inference and reinforcement learning. Statisticians combine the ideas of reinforcement learning like Q-learning into the causal inference frame, such as dynamic treatment regime. Computer scientists get inspired by some work in causal inference to estimate policy value, such as doubly robust estimator for off-policy evaluation. And I am excited about these connections, because causal inference has a long history, and it has built tons of good work; because reinforcement learning is getting more and more attention and has a lot of interesting ideas. Can we get more inspiration from each other? I think this is an emerging area and has a lot of possibilities to explore! I am looking forward to working on this and finding more!</p>
				</div>
				<!-- Additional questions -->
				<div class="col-12 blog-additional">
					<p class="blog-text3 horizontal-rule">Lili is a PhD candidate working with Laber Labs. Her research interests include  reinforcement learning and local linear models. We thought this posting was a great excuse to get to know a little more about her, so we asked her a question!</p>
					<ul>
						<li>
							<p class="interview-question">Do you have a motto?</p>
							<ul>
								<li class="blog-text2">人生得意须尽欢，莫使金樽空对月。<br>(When hopes are won, oh! drink your fill in utmost delight.<br>And never leave your wine-cup empty in moonlight!)</li>
								<li class="blog-text2">天生我材必有用，千金散尽还复来。<br>(Heaven has made us talents, we’re not made in vain.<br>A thousand gold coins spent, more will turn up again.)<br><br>—from 《将进酒(Invitation to Wine)》by 李白 (Li, Bai)</li>
							</ul>
						</li>
					</ul>
				</div>
			</div>
			<div class="row">
				<div class="col-12 d-flex flex-row-reverse">
					<div class="button2-container padding-left">
						<a href="pursuit-evasion.html" class="btn2 btn-primary2">Next <i class="fas fa-arrow-right"></i></a>
					</div>
					<div class="button2-container padding-left">
						<a href="uncovering-the-truth.html" class="btn2 btn-primary2"><i class="fas fa-arrow-left"></i> Previous</a>
					</div>
					<div class="button2-container padding-left">
						<a href="../studentblog.html" class="btn2 btn-primary2">View All Posts</a>
					</div>
				</div>
			</div>
		</div>
	</section>

	<section class="footer">
		<div class="container-fluid">
			<div class="row">
				<div class="col-lg-4 col-md-4 col-sm-12 footer-section">
				</div>
				<div class="col-lg-4 col-md-4 col-sm-12 footer-section">
					<span class="fa-stack fa-lg">
  						<a href="https://twitter.com/LaberLabs"><i class="fab fa-twitter"></i></a>
					</span>
					<span class="fa-stack fa-lg">
  						<a href="https://www.facebook.com/LaberLabs/"><i class="fab fa-facebook"></i></a>
					</span>
					<span class="fa-stack fa-lg">
  						<a href="https://www.youtube.com/c/LaberLabs"><i class="fab fa-youtube"></i></a>
					</span>
				</div>
				<div class="col-lg-4 col-md-4 col-sm-12 footer-section">
					<p class="footer-contact">Let's Talk Stats!</p>
					<p class="footer-email"><a href="mailto:laber@stat.ncsu.edu">laber@stat.ncsu.edu</a></p>
				</div>
			</div>
		</div>
	</section>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    <script type="text/javascript" src="../../js/main.js"></script>
</body>
